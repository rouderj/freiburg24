require('rjags')
m1.mod <-"
model {
for (i in 1:N){
Y[i] ~ dnorm(mu, invS2)}
mu ~ dnorm(a,1/b)
invS2 ~ dgamma(.5,.5*r)
}
"
runMod1 = function(Y,M){
setup=list(
"Y" = Y,
"N" = length(Y))
prior =list("a"=100,"b"=5^2,"r"=115^2)
pars = c("mu","invS2")
out=jags(data=c(setup,prior),
parameters=pars,
model.file = textConnection(m1.mod),
n.chains=1,n.iter=M,n.burnin=M/10,n.thin=1)
return(out)}
out=runMod1(c(92,115,100,98))
require('rjags')
m1.mod <-"
model {
for (i in 1:N){
Y[i] ~ dnorm(mu, invS2)}
mu ~ dnorm(a,1/b)
invS2 ~ dgamma(.5,.5*r)
}
"
runMod1 = function(Y,M=1000){
setup=list(
"Y" = Y,
"N" = length(Y))
prior =list("a"=100,"b"=5^2,"r"=115^2)
pars = c("mu","invS2")
out=jags(data=c(setup,prior),
parameters=pars,
model.file = textConnection(m1.mod),
n.chains=1,n.iter=M,n.burnin=M/10,n.thin=1)
return(out)}
out=runMod1(c(92,115,100,98))
require('R2Jags')
require('R2jags')
m1.mod <-"
model {
for (i in 1:N){
Y[i] ~ dnorm(mu, invS2)}
mu ~ dnorm(a,1/b)
invS2 ~ dgamma(.5,.5*r)
}
"
runMod1 = function(Y,M=1000){
setup=list(
"Y" = Y,
"N" = length(Y))
prior =list("a"=100,"b"=5^2,"r"=115^2)
pars = c("mu","invS2")
out=jags(data=c(setup,prior),
parameters=pars,
model.file = textConnection(m1.mod),
n.chains=1,n.iter=M,n.burnin=M/10,n.thin=1)
return(out)}
out=runMod1(c(92,115,100,98))
out=runMod1(c(92,115,100,98))
mu=out$BUGSoutput$sims.list$mu
s2=1/out$BUGSoutput$sims.list$invS2
hist(mu)
hist(s2)
out=runMod1(c(92,115,100,98))
mu=out$BUGSoutput$sims.list$mu
s2=1/out$BUGSoutput$sims.list$invS2
hist(mu)
hist(sqrt(s2))
out=runMod1(c(92,115,100,98))
s2=1/out$BUGSoutput$sims.list$invS2
mu=out$BUGSoutput$sims.list$mu
s2=1/out$BUGSoutput$sims.list$invS2
hist(mu)
hist(sqrt(s2))
rnorm(6,100,115x)
rnorm(6,100,115)
rnorm(6,100,15)
z=round(rnorm(6,100,15),0)
z
mean(z)
z=round(rnorm(6,100,15),0)
z-mean(z)
z=rnorm(6,100,15)
z
z-mean(z)+102
round(z-mean(z)+102,0)
Y=c(92,115,100,98)
ybar=mean(Y)
N=length(Y)
a=100
b=25
q=.5
r=.5*15^2
M=20000 # number of samples
mu=1:M
s2=1:M
mu[1]=100 #initial value
s2[1]=100 #initial value
for (m in 2:M){
v=1/(N/s2[m-1]+1/b)
c=N*ybar/s2[m-1]+a/b
mu[m]=rnorm(1,c*v,sqrt(v))
SSE=sum((y-mu[m])^2)
s2[m]=rinvgamma(1,N/2+q,SSE/2+r)
}
Y=c(92,115,100,98)
ybar=mean(Y)
N=length(Y)
a=100
b=25
q=.5
r=.5*15^2
M=20000 # number of samples
mu=1:M
s2=1:M
mu[1]=100 #initial value
s2[1]=100 #initial value
for (m in 2:M){
v=1/(N/s2[m-1]+1/b)
c=N*ybar/s2[m-1]+a/b
mu[m]=rnorm(1,c*v,sqrt(v))
SSE=sum((y-mu[m])^2)
s2[m]=rinvgamma(1,N/2+q,SSE/2+r)
}
for (m in 2:M){
v=1/(N/s2[m-1]+1/b)
c=N*ybar/s2[m-1]+a/b
mu[m]=rnorm(1,c*v,sqrt(v))
SSE=sum((Y-mu[m])^2)
s2[m]=rinvgamma(1,N/2+q,SSE/2+r)
}
m1.mod <-"
model {
for (i in 1:N){
Y[i] ~ dnorm(mu, invS2)}
mu ~ dnorm(a,1/b)
invS2 ~ dgamma(.5,.5*r)
}
"
runMod1 = function(Y,M=1000){
setup=list(
"Y" = Y,
"N" = length(Y))
prior =list("a"=100,"b"=5^2,"r"=15^2)
pars = c("mu","invS2")
out=jags(data=c(setup,prior),
parameters=pars,
model.file = textConnection(m1.mod),
n.chains=1,n.iter=M,n.burnin=M/10,n.thin=1)
return(out)}
require('R2jags')
m1.mod <-"
model {
for (i in 1:N){
Y[i] ~ dnorm(mu, invS2)}
mu ~ dnorm(a,1/b)
invS2 ~ dgamma(.5,.5*r)
}
"
runMod1 = function(Y,M=1000){
setup=list(
"Y" = Y,
"N" = length(Y))
prior =list("a"=100,"b"=5^2,"r"=15^2)
pars = c("mu","invS2")
out=jags(data=c(setup,prior),
parameters=pars,
model.file = textConnection(m1.mod),
n.chains=1,n.iter=M,n.burnin=M/10,n.thin=1)
return(out)}
out=runMod1(c(92,115,100,98))
mu=out$BUGSoutput$sims.list$mu
s2=1/out$BUGSoutput$sims.list$invS2
hist(mu)
hist(sqrt(s2))
